<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HYPERSPACE SURREAL | Vortex</title>
  <link href="https://fonts.googleapis.com/css2?family=Syncopate:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body { margin: 0; background: #000; overflow: hidden; font-family: 'Syncopate', sans-serif; }
    canvas { display: block; filter: contrast(1.2) saturate(1.5); }
    
    #ui {
      position: absolute; bottom: 40px; width: 100%;
      display: flex; justify-content: center; gap: 50px;
      color: rgba(0, 255, 255, 0.7); pointer-events: none;
      letter-spacing: 4px; font-size: 0.8em;
    }

    #overlay {
      position: absolute; inset: 0; background: radial-gradient(circle, transparent 0%, #000 100%);
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1); z-index: 10;
    }

    .title { color: #fff; font-size: 3em; font-weight: 700; text-shadow: 0 0 20px #0ff; margin-bottom: 5px; }
    .btn {
      background: none; border: 1px solid #fff; color: #fff;
      padding: 15px 60px; cursor: pointer; font-family: inherit;
      transition: 0.4s; clip-path: polygon(10% 0, 100% 0, 90% 100%, 0 100%);
    }
    .btn:hover { background: #fff; color: #000; box-shadow: 0 0 40px #fff; transform: scale(1.1); }
    
    .danger { color: #ff0055; display: none; margin-bottom: 20px; }
  </style>
</head>
<body>

<div id="ui">
  <div>VELOCITY: <span id="vel">0</span></div>
  <div>SCORE: <span id="score">0</span></div>
  <div>HIGH: <span id="best">0</span></div>
</div>

<div id="overlay">
  <div id="death-msg" class="danger">SYSTEM CRITICAL: COLLISION DETECTED</div>
  <div class="title">VORTEX</div>
  <p style="color: #444; margin-bottom: 30px;">LIMIT-BREAK PROTOCOL</p>
  <button class="btn" onclick="init()">START LINK</button>
</div>

<canvas id="vortex"></canvas>

<script>
const canvas = document.getElementById('vortex');
const ctx = canvas.getContext('2d');
const overlay = document.getElementById('overlay');
const scoreEl = document.getElementById('score');
const velEl = document.getElementById('vel');
const bestEl = document.getElementById('best');

let w, h, player, stars, cubes, active, frame, speed, score, highscore;

highscore = localStorage.getItem('vortex_high') || 0;
bestEl.innerText = highscore;

function resize() {
  w = canvas.width = window.innerWidth;
  h = canvas.height = window.innerHeight;
}
window.addEventListener('resize', resize);
resize();

// Input
const mouse = { x: 0, y: 0 };
window.addEventListener('mousemove', e => {
  mouse.x = (e.clientX - w/2) / (w/2);
  mouse.y = (e.clientY - h/2) / (h/2);
});

class Star {
  constructor() { this.reset(); }
  reset() {
    this.x = (Math.random() - 0.5) * 3000;
    this.y = (Math.random() - 0.5) * 3000;
    this.z = Math.random() * 2000;
  }
  update() {
    this.z -= speed * 1.5;
    if (this.z < 1) this.reset();
  }
  draw() {
    const s = 600 / this.z;
    const px = w/2 + this.x * s;
    const py = h/2 + this.y * s;
    const size = (1 - this.z / 2000) * 3;
    
    ctx.fillStyle = `rgba(255, 255, 255, ${1 - this.z/2000})`;
    // Efeito de rastro (streak)
    const stretch = speed * 0.2;
    ctx.fillRect(px, py, size, size * stretch);
  }
}

class Cube {
  constructor() {
    this.reset();
    this.z = 2000;
  }
  reset() {
    this.x = (Math.random() - 0.5) * 1500;
    this.y = (Math.random() - 0.5) * 1500;
    this.z = 2000;
    this.size = Math.random() * 50 + 20;
    this.rot = Math.random() * Math.PI;
  }
  update() {
    this.z -= speed;
    this.rot += 0.02;
    if (this.z < 1) {
      if (Math.abs(this.x * (600/10) - player.x*150) < 100 && 
          Math.abs(this.y * (600/10) - player.y*150) < 100) {
        gameOver();
      }
      this.reset();
      score += 10;
    }
  }
  draw() {
    const s = 600 / this.z;
    const px = w/2 + this.x * s;
    const py = h/2 + this.y * s;
    const sz = this.size * s;

    ctx.save();
    ctx.translate(px, py);
    ctx.rotate(this.rot);
    ctx.strokeStyle = `hsl(${(frame + this.z/5)%360}, 100%, 70%)`;
    ctx.lineWidth = 2;
    ctx.shadowBlur = 15;
    ctx.shadowColor = ctx.strokeStyle;
    ctx.strokeRect(-sz/2, -sz/2, sz, sz);
    ctx.restore();
  }
}

function init() {
  player = { x: 0, y: 0 };
  stars = Array.from({length: 400}, () => new Star());
  cubes = Array.from({length: 12}, () => new Cube());
  speed = 10;
  score = 0;
  frame = 0;
  active = true;
  overlay.style.opacity = '0';
  overlay.style.pointerEvents = 'none';
  document.getElementById('death-msg').style.display = 'none';
  loop();
}

function gameOver() {
  active = false;
  overlay.style.opacity = '1';
  overlay.style.pointerEvents = 'auto';
  document.getElementById('death-msg').style.display = 'block';
  if (score > highscore) {
    highscore = score;
    localStorage.setItem('vortex_high', highscore);
    bestEl.innerText = highscore;
  }
}

function loop() {
  if (!active) return;

  // Fade surreal para rastro
  ctx.fillStyle = 'rgba(0, 0, 0, 0.15)';
  ctx.fillRect(0, 0, w, h);

  // Suavização da nave
  player.x += (mouse.x - player.x) * 0.1;
  player.y += (mouse.y - player.y) * 0.1;

  // Movimento de câmera surreal
  ctx.save();
  ctx.translate(-player.x * 50, -player.y * 50);

  stars.forEach(s => { s.update(); s.draw(); });
  cubes.forEach(c => { c.update(); c.draw(); });

  ctx.restore();

  // Crosshair (Mira)
  ctx.strokeStyle = '#0ff';
  ctx.lineWidth = 1;
  ctx.beginPath();
  const mx = w/2 + mouse.x * 100;
  const my = h/2 + mouse.y * 100;
  ctx.arc(mx, my, 20, 0, Math.PI*2);
  ctx.moveTo(mx - 30, my); ctx.lineTo(mx + 30, my);
  ctx.moveTo(mx, my - 30); ctx.lineTo(mx, my + 30);
  ctx.stroke();

  // Update UI
  scoreEl.innerText = score;
  velEl.innerText = Math.floor(speed * 20) + " KM/S";
  speed += 0.005;
  frame++;

  requestAnimationFrame(loop);
}
</script>
</body>
</html>
