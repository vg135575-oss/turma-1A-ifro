<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Corrida</title>
<style>
body { margin:0; overflow:hidden; background:black; }
</style>
</head>

<body>

<script type="module">

import * as THREE from "https://cdn.jsdelivr.net/npm/three@0.154/build/three.module.js";
import { GLTFLoader } from "https://cdn.jsdelivr.net/npm/three@0.154/examples/jsm/loaders/GLTFLoader.js";

const scene = new THREE.Scene();

const camera = new THREE.PerspectiveCamera(60, window.innerWidth/window.innerHeight, 0.1, 1000);
camera.position.set(0,3,8);

const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

const light = new THREE.HemisphereLight(0xffffff, 0x444444);
scene.add(light);


// ===== CHÃƒO =====
const floor = new THREE.Mesh(
 new THREE.PlaneGeometry(6,200),
 new THREE.MeshStandardMaterial({color:0x333333})
);
floor.rotation.x = -Math.PI/2;
scene.add(floor);


// ===== CARRO =====
let car;
const loader = new GLTFLoader();

loader.load("carro.glb", (gltf)=>{

 car = gltf.scene;

 car.scale.set(1,1,1);
 car.position.set(0,0,0);

 scene.add(car);

 console.log("CARREGOU");

}, undefined, (err)=>{
 console.log("ERRO AO CARREGAR", err);
});


// ===== CONTROLES TOUCH =====
let lane = 0;

window.addEventListener("touchstart", (e)=>{
 if(e.touches[0].clientX < window.innerWidth/2) lane--;
 else lane++;

 lane = Math.max(-1, Math.min(1, lane));
});


// ===== LOOP =====
function animate(){

 requestAnimationFrame(animate);

 if(car){
 car.position.x += ((lane*2) - car.position.x) * 0.1;
 }

 renderer.render(scene,camera);
}

animate();

</script>

</body>
</html>
